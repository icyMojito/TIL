# # SQL 첫걸음

### [ 1강 : 데이터베이스 ]

#### 데이터베이스(DB)

- 컴퓨터 안에 기록되어 있는 숫자, 즉 데이터의 집합
- 특정 데이터를 확인하고 싶을 때 간단하게 찾아낼 수 있도록 정리된 형태
- 데이터는 영구적으로 보존되어야 하므로 하드디스크나 플래시메모리(SDD) 등 비휘발성 저장장치에 저장

#### 데이터베이스 관리 시스템(DBMS)

- 데이터베이스를 효율적으로 관리하는 소프트웨어
- 생산성 : 데이터 검색, 추가, 삭제, 갱신과 같은 처리를 제공하여 시스템 개발 과정의 생산성을 향상
- 기능성 : 데이터베이스를 다루는 기능을 많이 제공함 /ex: 복수 유저의 요청에 대응, 고속 검색 기능 제공
- 신뢰성 : 데이터 집어넣기 및 내보내기 기능을 통해 데이터베이스를 간단히 백업 가능

#### 데이터베이스를 조작하는 언어 SQL

- '<u>관계형 데이터베이스 관리 시스템(RDBMS)</u>'을 조작할 때 사용
- 표준 언어
- SQL 명령의 종류
  1. DML : 데이터를 조작할 때 사용. 새로운 데이터 추가, 삭제, 내용 갱신 등. SQL의 가장 기본이 되는 명령셋(set)
  2. DDL : 데이터를 정의할 때 사용. 데이터베이스는 '데이터베이스 객체(object)'라는 데이터 그릇을 이용하여 데이터를 관리하는데, 이 같은 객체를 만들거나 삭제하는 명령어
  3. DCL : 데이터를 제어할 때 사용. 트랜잭션을 제어하는 명령과 데이터 접근권한을 제어하는 명령이 포함됨



### [ 2강 : 다양한 데이터베이스 ]

#### 데이터베이스 종류

- 계층형 데이터베이스 : 폴더와 파일 등의 계층 구조로 데이터를 저장하는 방식. 하드디스크나 DVD 파일 시스템 등
- **<u>관계형 데이터베이스</u>** : 행과 열을 가지는 표 형식 데이터를 저장하는 형태의 데이터베이스. SQL 명령어로 데이터 조작 가능
- 객체지향 데이터베이스 : 가능하면 객체 그대로를 데이터베이스의 데이터로 저장하는 방식
- XML 데이터베이스 : XML이란 자료 형식으로 기록된 데이터를 저장하는 데이터베이스. XQuery라는 전용 명령어 사용
- 키-밸류 스토어(KVS) : 키와 그에 대응하는 값(밸류)이라는 단순한 형태의 데이터를 저장하는 열 지향 데이터베이스

#### 데이터베이스 제품

- RDBMS : 관계형 데이터베이스를 관리하는 소프트웨어
  - Oracle, DB2, SQL Server, PostgreSQL, MySQL, SQLite

#### SQL의 방언과 표준화

- 특정 데이터베이스 관리 소프트웨어에만 통용되는 고유 방언이 생겨나 많은 RDBMS가 표준화에 동참
- 방언 대신 <u>표준 SQL을 사용</u>하자!



### [ 3강 : 데이터베이스 서버 ]

#### 클라이언트/서버 모델

- 사용자 조작에 따라 요청을 전달하는 '클라이언트'와 해당 요청을 받아 처리하는 '서버'로 소프트웨어를 나누고, 복수의 컴퓨터에서 하나의 모델을 구현하는 시스템
- 복수의 클라이언트가 보내오는 요청에 응답할 수 있도록 많은 RDBMS가 채택해서 가동하는 모델. 클라이언트가 많아져 서버의 능력이 부족해지면 추가로 설치하여 부하 분산해 시스템 전체의 성능을 높일 수 있음(유연한 하드웨어 구성 실현)
- 데이터베이스를 사용하기 위해서는 <u>사용자 인증</u>(ID와 비밀번호 이용)을 거쳐야 함
- RDBMS에 접속하면 SQL 명령을 서버에 보낼 수 있음

#### 웹 애플리케이션의 구조

- 웹 서버의 CGI 프로그램(동적으로 HTML을 생성하기 위한 제어용 프로그램)이 데이터베이스의 클라이언트가 됨
- 웹 서버와 데이터베이스 서버가 네트워크로 연결되어 있다면, 서로 다른 머신에 두어 처리를 분산시켜 시스템 전체 성능을 향상시킬 수 있음

#### MySQL 서버와 mysql 클라이언트

- MySQL 패키지를 인스톨하면 서버와 클라이언트 모두 사용 가능
- MySQL 서비스 = 데이터베이스 서버 & mysql 커맨드 = 클라이언트
- MySQL 서비스는 PC 기동과 함께 자동으로 실행됨
- PC 한 대로 클라이언트에서 서버로 접속할 때, 네트워크를 경유해서 PC의 서버로 되돌아오는 형태의 접속을 '루프 백 접속'이라 부름



### [ 4강 : Hello World 실행하기 ]

#### 'SELECT * FROM 테이블명;' 실행

- 프로그래밍 언어를 배울 때 가장 처음 만들어보는 간단한 프로그램인 Hello World에 해당하는 SQL 명령문
- SQL 명령의 마지막에는 세미콜론(;)을 붙여야 한다.

#### SELECT 명령 구문

**````SELECT * FROM 테이블명;````**

- SELECT : 데이터베이스의 데이터를 읽어올 수 있는 명령. '질의'나 '쿼리'라 불리기도 함
- 애스터리스크(*) : '모든 열'을 의미하는 메타문자
- FROM : 처리 대상 테이블을 지정하는 키워드
- <u>SQL 명령은 키워드에 의해 '구'라는 단위로 나눌 수 있다.</u> 현재 예시에서는 SELECT구와 FROM구로 나눌 수 있다.

#### 예약어와 데이터베이스 객체명

- SELECT와 FROM이 구를 결정하는 키워드이자 예약어(예약되어 있는 단어)
- 데이터베이스에는 테이블 외에 다양한 데이터를 저장하거나 관리하는 '어떤 것' = '데이터베이스 객체'를 만들 수 있음
- 데이터베이스 객체는 이름을 붙여 관리하며 중복된 이름의 객체가 존재할 수 없음. 또한 예약어와 동일한 이름도 사용 불가
- 예약어와 데이터베이스 객체명은 대소문자를 구별하지 않는다.

#### Hello World를 실행한 결과 = 테이블

- 테이블은 행(레코드)과 열(컬럼/필드)로 구성된 표 형식의 데이터
- 각각의 행과 열이 만나는 부분인 '셀'에는 하나의 데이터 값이 저장되어 있음
- 데이터 자료형 분류
  - 수치형 데이터 : 숫자만으로 구성된 데이터. 오른쪽 정렬로 표시
  - 문자열 데이터 : 임의의 문자로 구성된 데이터. 왼쪽 정렬로 표시
  - 날짜시간형 데이터 : 날짜와 시각을 나타내는 데이터. 왼쪽 정렬로 표시
- <u>열은 하나의 자료형만 가질 수 있다.</u>

#### 값이 없는 데이터 = NULL

- NULL : 특별한 데이터 값으로 <u>아무것도 저장되어 있지 않은 상태</u>를 의미 = NULL이라는 데이터가 저장되어 있는 것이 아님!



### [ 5강 : 테이블 구조 참조하기 ]

#### DESC 명령

***````DESC 테이블명;````***

- SQL 명령이 아니다.
- 테이블에 어떤 열이 정의되어 있는지, 즉 테이블의 구조를 알 수 있다.
  - Field : 열 이름
  - Type : 해당 열의 '자료형'
    - 괄호 안의 숫자는 최대 길이
  - Null : NULL 값을 허용할 것인지 아닌지를 나타내는 제약사항
    - YES로 지정하면 NULL값을 허용
  - Key : 해당 열이 '키'로 지정되어 있는지를 나타냄. 행을 특정하기 위해 사용할 수 있는 열
  - Default : 그 열에 주어진 '기본값', 즉 데이터 값을 생략했을 경우 적용되는 값

#### 자료형

- INTEGER 형 : 수치형의 하나로 정수값을 저장할 수 있는 자료형. 소수점은 포함 불가
- CHAR 형 : 문자열형의 하나로 문자열을 저장할 수 있는 자료형. 열의 최대 길이를 지정해야 함. '고정 길이 문자열' 자료형. 최대 길이보다 작은 문자열을 저장하면 공백문자로 나머지를 채운 후 저장함
- VARCHAR 형 : 문자열형의 하나로 문자열을 저장할 수 있는 자료형. 열의 최대 길이를 지정하되, 데이터 크기에 맞춰 저장공간의 크기도 변경됨. '가변 길이 문자열' 자료형
- DATE 형 : 날짜값을 지정할 수 있는 자료형
- TIME 형 : 시간을 저장할 수 있는 자료형



### [ 6강 : 검색 조건 지정하기 ]

#### SELECT 구에서 열 지정하기

***````SELECT 열1, 열2 ... FROM 테이블명;````***

- 열은 콤마(,)를 이용하여 구분 지으며 여러 개를 지정할 수 있음
- 결과는 지정한 열의 순서대로 표시되며 동일한 열을 중복해서 지정해도 무관
- 열을 지정하지 않거나 테이블에 존재하지 않는 열을 지정하면 에러 발생

#### WHERE 구에서 행 지정하기

***```SELECT 열 FROM 테이블명 WHERE 조건식;```***

- WHERE 구는 FROM 구의 뒤에 표기해야 함
  - WHERE 구를 생략하면 테이블 내의 모든 행이 검색 대상
- 예약어 'WHERE' 뒤에 검색 조건을 표기하면 조건에 일치하는 행만 SELECT의 결과로 반환
  - 조건식 : 열과 연산자, 상수로 구성되는 식 /ex: no = 2
  - 조건식은 참 또는 거짓의 진리값을 반환하는 식으로 비교 연산자를 사용해 표현
  -  <> : 서로 다른 값인지를 비교하는 연산자. 서로 다른 값이면 참이 되는 조건식으로 변경할 수 있음 /ex: no <> 2
  - 비교 연산자 : =, <>, >, >=, <, <=

#### 문자열형의 상수

- 수치형 조건식은 비교할 숫자 = 리터럴을 그대로 조건식에 표기
- 문자열형 조건식은 비교할 문자 = 리터럴을 싱글쿼트(' ')로 둘러싸 표기해야 함 /ex: name = '홍길동'
- 날짜시간형 조건식도 비교할 날짜시간 = 리터럴을 싱글쿼트(' ')로 둘러싸 표기해야 함
  - 연월일은 하이픈(-)으로 구분 /ex: '2020-03-05'
  - 시각은 시분초를 콜론(:)으로 구분 /ex: '2020-03-05 10:21:58'

#### NULL값 검색

***```SELECT 열 FROM 테이블명 WHERE ??? IS NULL;```***

- NULL 값 검색에는 = 연산자가 아닌 'IS NULL'을 사용



### [ 7강 : 조건 조합하기 ]

#### AND로 조합하기

***```조건식1 AND 조건식2```***

- 논리곱을 계산하는 논리연산자
- 좌우에 항목이 필요한 이항 연산자이며, 좌우의 식 모두 참일 경우 참을 반환
- AND로 조건식을 연결하면 모든 조건을 만족하는 행을 검색할 수 있음

#### OR로 조합하기

***```조건식1 OR 조건식2```***

- 논리합을 계산하는 논리연산자
- 좌우에 항목이 필요한 이항 연산자이며, 어느 쪽이든 조건을 만족하면 참을 반환
- OR로 조건식을 연결하면 어느 쪽이든 조건을 만족하는 행을 모두 검색할 수 있음

#### AND와 OR를 사용할 경우 주의할 점

- AND가 OR보다 계산 우선순위가 높음
- 조건이 잘못 지정되지 않도록 조건식을 괄호()로 묶어두는 것이 좋음

#### NOT으로 조합

***```NOT 조건```***

- 오른쪽에만 항목을 지정하는 단항 연산자
- 오른쪽에 지정한 조건식의 반대 값을 반환
- 주로 복수의 조건식에 대해 '~아닌', '~외에', '~를 제외한 나머지' 등의 조건을 지정할 경우 사용



### [ 8강 : 패턴 매칭에 의한 검색 ]

- <u>패턴 매칭 : 부분 검색과 같은 말. 특정 문자나 문자열이 포함되어 있는지를 검색하고 싶은 경우 사용하는 방법</u>

#### LIKE로 패턴 매칭하기

***```열명 LIKE '패턴'```***

- LIKE 술어는 왼쪽에 매칭 대상을 지정, 오른쪽에는 패턴을 문자열로 지정
- 패턴으로 수치형 상수는 지정 불가능
- 패턴을 정의할 때 메타문자를 사용
  - 메타문자 : 패턴 매칭 시 '임의의 문자 또는 문자열'에 매치하는 부분을 지정하기 위해 쓰이는 특수 문자
    - % : 임의의 문자열. 빈 문자열에도 매치 가능
    - _ : 임의의 문자 하나
  - 전방 일치, 중간 일치, 후방 일치 /ex: SQL%, %SQL%, %SQL

#### LIKE로 %를 검색하기

***```WHERE ??? LIKE '%\%%'```*** 

- 메타문자와 동일한 문자를 LIKE로 검색할 때는 '이스케이프'라는 방법을 사용
- \% : \가 있어 이스케이프 된 것을 의미하므로 일반문자 %를 의미
- \ _ : \가 있어 이스케이프 된 것을 의미하므로 일반문자 _를 의미

#### 문자열 상수 '의 이스케이프

- '를 2개 연속해서 기술하는 것으로 이스케이프 처리
- 'It''s' = It's를 검색할 때
- '''' = '하나만 문자열 데이터일 경우



### [ 9강 : 정렬 - ORDER BY ]

#### ORDER BY로 검색 결과 정렬하기

***```SELECT 열명 FROM 테이블명 WHERE 조건식 ORDER BY 열명```***

- SELECT 명령의 ORDER BY 구로 정렬하고 싶은 열 지정
- WHERE 구가 있으면 WHERE 구 뒤에 ORDER BY 구를 지정, WHERE 구를 생략하면 FROM 구 뒤에 지정
- 기본 정렬 방법은 오름차순

#### ORDER BY DESC로 내림차순으로 정렬하기

***```SELECT 열명 FROM 테이블명 ORDER BY 열명 DESC```***

#### 대소관계

- ORDER BY로 정렬할 떄는 값의 대소관계가 중요
  - 수치형 데이터 : 숫자의 크기로 판별
  - 날짜시간형 데이터 : 숫자의 크기로 판별
  - 문자열형 데이터 : 사전식 순서로 판별 (알파벳 ▸ 한글(자음, 모음))
- 문자열형 열에 숫자를 저장하면 문자로 인식되어 대소관계의 계산 방법이 달라짐

#### ORDER BY는 테이블에 영향을 주지 않는다

- not 저장장치에 저장된 데이터의 행 순서 변경 but 서버에서 클라이언트로 행 순서를 바꾸어 결과를 반환하는 것



### [ 10강 : 복수의 열을 지정해 정렬하기 ]

#### 복수 열로 정렬 지정

***```SELECT 열명 FROM 테이블명 ORDER BY 열명1, 열명2, ...```***

- ORDER BY 구에 복수의 열을 지정
- 지정한 열명의 순서에 따라 정렬함

#### 정렬방법 지정하기

***```SELECT 열명 FROM 테이블명 ORDER BY 열명1 [ASC|DESC], 열명2 [ASC|DESC], ...```***

- 복수 열을 지정했을 때, 각 열에 대해 개별적으로 정렬방법을 지정 가능

#### NULL 값의 정렬순서

- 특성상 대소비교를 할 수 없어 정렬 시에는 별도의 방법으로 취급
- ORDER BY로 지정한 열에서 NULL 값을 가지는 행은 가장 먼저 표시되거나 가장 나중에 표시됨
- 표준 SQL에도 규정되어 있지 않아 데이터베이스 제품에 따라 기준이 다름



### [ 11강 : 결과 행 제한하기 - LIMIT ]

#### 행수 제한

***```SELECT 열명 FROM 테이블명 WHERE 조건식 ORDER BY 열명 LIMIT 행수```***

- LIMIT 구는 표준 SQL이 아니라 MySQL과 PostgreSQL에서 사용 가능한 문법
- FROM 구, WHERE 구나 ORDER BY 구의 뒤에 지정
- LIMIT 다음에는 최대 행수를 수치로 지정하여, 반환될 행수를 제한 가능

#### 오프셋 지정

***```SELECT 열명 FROM 테이블명 LIMIT 행수 OFFSET 위치```***

- OFFSET에 의한 시작 위치 지정은 LIMIT 뒤에 기술

  /ex : LIMIT 3 OFFSET 3; = 4행부터 3건의 데이터를 표시

- OFFSET은 생략 가능하며 기본값은 0



### [ 12강 : 수치 연산 ]

#### 사칙 연산

- 우선순위 : * / %  ➤  + -
- 우선 순위가 같다면 왼쪽에서 오른쪽으로 계산 

#### SELECT 구로 연산하기

***```SELECT 식1, 식2 ... FROM 테이블명;```***

- SELECT 구에는 여러가지 식을 기술할 수 있음
- 식은 열명, 연산자, 상수로 구성됨 /ex: 열1 * 열2

#### 열의 별명

***```SELECT 식1 AS 별명 FROM 테이블명;```***

- 식을 구성하는 열 이름이 길고 알아보기 어려우면 별명을 붙여 열명을 재지정할 수 있음
- 별명은 예약어 AS를 사용해 지정하되 생략도 가능
- 별명을 한글로 지정할 경우 더블쿼트로 둘러싸서 지정 (MySQL에서는 백쿼트)
  - 싱글쿼트는 문자열 상수를 감싸기
  - 더블쿼트는 데이터베이스 객체의 이름을 감싸기
- 별명을 지정하는 경우 숫자로 시작되지 않도록 하자
  - 수치형 상수를 의미하는지 데이터베이스 객체명을 의미하는지 구별이 불가능하기 때문

#### WHERE 구에서 연산하기

- 조건식에 연산을 넣어 검색 가능
- 서버 내부의 처리 순서(WHERE 구 ▸ SELECT 구) 때문에 SELECT 구에서 지정한 별명은 WHERE 구 안에서 사용할 수 없음

#### NULL 값의 연산

- NULL로 연산하면 결과는 NULL이 됨

#### ORDER BY 구에서 연산하기

- 서버 내부에서 가장 나중에 처리되므로 SELECT 구에서 지정한 별명 사용 가능

#### 함수

***```함수명(인수1, 인수2 ...)```***

- 표기방법이 다를 뿐 연산자와 같은 것
- 계산 대상을 인수로 지정 vs 연산자는 좌우의 항목이 계산 대상
- 함수명에 따라 연산 방법이 결정됨 vs 연산자는 기호에 따라 연산 방법이 결정됨
- 함수, 연산자 모두 결과값을 반환

#### ROUND 함수

- 기본적으로 소수점 첫째 자리를 기준으로 반올림한 값을 반환
- 두 번째 인수로 반올림할 자리를 지정 가능 
  - 생략 시 0으로 간주
  - 음수 지정 시 정수부의 반올림할 자릿수 지정 /ex: -2를 지정하면 10단위를 반올림