## # MVC 패턴

- JSP(Java Server Pages) 웹 어플리케이션의 구조는 크게 모델 1 구조와 모델 2 구조로 나누어짐

| <span style="color:limegreen">모델 1 구조</span>             | <span style="color:palevioletred">모델 2 구조</span>         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 웹 브라우저의 요청을 받은 JSP가 자바빈이나 서비스 클래스를 사용해서 웹 브라우저가 요청한 작업을 처리하고 그 결과를 클라이언트에 출력한다. 따라서 JSP 페이지에 비즈니스 로직을 처리하기 위한 코드와 웹 브라우저에 결과를 출력하는 코드가 섞인다. | 웹 브라우저의 모든 요청을 하나의 서블릿이 받아 알맞게 처리(로직 처리)한 후 결과를 보여줄 JSP 페이지로 포워딩하면 요청 흐름을 받은 JSP 페이지는 결과 화면을 클라이언트에 전송한다. 구조의 특징으로 MVC 패턴을 이용해서 웹 어플리케이션을 구현할 때 사용된다. |

- **MVC 패턴의 요소**
  - **Model** : 비즈니스 영역의 로직을 처리
  - **View** : 비즈니스 영역에 대한 프레젠테이션 뷰 담당 (사용자가 보게 될 결과 화면)
  - **Controller** : 사용자의 입력 처리와 흐름 제어 담당

- **사용자 요청  ▷  컨트롤러  ▷  모델을 이용해서 요청 처리  ▷  뷰 선택   ▷  사용자에게 응답**
  - 어플리케이션의 흐름 제어나 사용자의 처리 요청은 컨트롤러에 집중
  - 비즈니스 로직을 처리하는 모델과 결과 화면을 보여주는 뷰를 분리
  - 뷰가 사용자에게 결과 화면을 보여줄 때 필요한 데이터는 컨트롤러를 통해 전달받음
- 유지보수 작업이 쉬워지고 어플리케이션을 쉽게 확장할 수 있음
  - 모델과 뷰가 분리되어 서로가 변경되더라도 영향을 받지 않음

#### _MVC 패턴과 모델 2 구조의 매핑_

- **사용자 = 웹 브라우저 내지 휴대폰과 같은 다양한 기기**

- **컨트롤러 = 서블릿**

  - 서블릿의 웹 브라우저 요청 처리 과정

    1. 웹 브라우저가 전송한 HTTP 요청 수신하고 서블릿의 doGet() 메서드나 doPost() 메서드가 호출됨

    2. 웹 브라우저가 어떤 기능을 요청했는지 분석 (예시: 게시판 목록 조회, 글쓰기 요청 등)

       - 판단 방법으로 가장 일반적인 것은 명령어 사용

         - 웹 브라우저를 통해 명령어를 전달하는 방법

           1. 특정 이름의 파라미터에 명령어 정보를 전달
           2. 요청 URI 자체를 명령어로 사용

         - 커맨드 패턴 : 하나의 명령어에 해당되는 로직 처리 코드를 별도의 클래스로 작성하여 구현

           ​			명령어를 처리하는 클래스들은 동일한 인터페이스를 상속해서 구현

           ​			각 클래스가 구현할 메서드는 세 가지 작업을 처리함

           ​				(1) 명렁어와 관련된 비즈니스 로직 처리 

           ​				(2) 뷰 페이지에서 사용할 정보 저장

           ​				(3) 뷰 페이지의 URI 반환

    3. 모델을 사용하여 요청한 기능을 수행

    4. 모델로부터 전달받은 결과물을 알맞게 가공한 후 request나 session의 setAttribute() 메서드를 사용하여 결과값을 속성에 저장. 이 결과값은 뷰인 JSP에서 사용

    5. 웹 브라우저에 결과를 전송할 JSP를 선택한 후, 해당 JSP로 포워딩. 경우에 따라 리다이렉트 실행

- **모델 = 로직 처리 클래스, 자바빈**

  - 명확하게 어떤 것을 통해 구현한다는 규칙이 없음
  - 웹 브라우저의 요청을 처리하는데 필요한 기능을 제공해야 함
  - 모델의 업무 흐름
    1. 컨트롤러로부터 요청 수신
    2. 비즈니스 로직 수행. 서비스 클래스나 DAO 클래스를 이용
    3. 수행 결과를 컨트롤러에 반환. 처리한 결과값을 저장하는 객체로 보통 자바빈을 사용

- **뷰 = JSP**

  - 일반 JSP와 동일한 형태
  - 컨트롤러에서 request 기본 객체나 session 기본 객체에 저장한 데이터를 사용하여 웹 브라우저에 알맞은 결과 출력
  - 웹 브라우저의 요청을 컨트롤러에 전달해주는 매개체의 역할도 수행 (예시: 링크나 폼 제공)



#### MVC 패턴과 모델 2 구조의 매핑_

- **사용자 = 웹 브라우저 내지 휴대폰과 같은 다양한 기기**

- **컨트롤러 = 서블릿**

  - 서블릿의 웹 브라우저 요청 처리 과정

    1. 웹 브라우저가 전송한 HTTP 요청 수신하고 서블릿의 doGet() 메서드나 doPost() 메서드가 호출됨

    2. **웹 브라우저가 어떤 기능을 요청했는지 분석 (예시: 게시판 목록 조회, 글쓰기 요청 등)**

       - 판단 방법으로 가장 일반적인 것은 URL로 전달받은 명령어 분석

         - 웹 브라우저를 통해 URL로 명령어를 전달하는 방법

           1. 특정 이름의 파라미터에 명령어 정보를 전달

              / 명령어 기반의 파라미터는 컨트롤러의 URL이 사용자에게 노출되어 공격받을 수 있음

           2. 요청 URI 자체를 명령어로 사용

              / 사용자의 악의적인 잘못된 명령어 입력을 일차적으로 예방하고, URL 자체의 의미로 기능 설명 가능

         - **커맨드 패턴** : 하나의 명령어에 해당되는 로직 처리 코드를 별도의 클래스로 작성하여 구현

           ​			명령어를 처리하는 클래스들은 동일한 인터페이스를 상속해서 구현

           ​			각 클래스가 구현할 메서드는 세 가지 작업을 처리함

           ​				(1) 명렁어와 관련된 비즈니스 로직 처리 

           ​				(2) 뷰 페이지에서 사용할 정보 저장

           ​				(3) 뷰 페이지의 URI 반환

           ​			**✻** **<명령어, 핸들러 클래스>의 매핑 정보를 설정 파일에 저장하기**

           ​				_형태: '명령어=핸들러 클래스 이름'_

           ​				컨트롤러 서블릿에서 init() 메서드(서블릿을 생성하고 초기화) 실행 시 설정 파일을 읽어오기

- **모델 = 로직 처리 클래스, 자바빈**



### ▣ 참조 링크

- http://wiki.hash.kr/index.php/%EB%A9%94%EB%AA%A8%EB%A6%AC
- https://m.blog.naver.com/dhksenzhd20/70127264988
- http://tcpschool.com/c/c_memory_structure